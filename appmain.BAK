* /// <summary>
* /// Clase Inicial del aplicativo
* /// </summary>
DEFINE CLASS clAppMain AS Custom
	oErrorController = .Null.
	oConnectionSQL = .Null.
	
	* /// <summary>
	* /// Procedimiento Init: Inicialización de la clase
	* /// </summary>
	PROCEDURE Init()
		PRIVATE oController AS Object, oForm AS Form
		
		This.SetPath()
		
		SET PROCEDURE TO ;
			"clUserController", ;
			"clConnectionSQL", ;
			"clErrorController", ;
			"clForm" ;
		ADDITIVE
		
		oConnectionSQL = This.GetConnection()
		
		oErrorController = CREATEOBJECT("clErrorController")
		
		oController = CREATEOBJECT(;
			"clUserController", ; 	&& Controladore Base
			oConnectionSQL, ;  	&& Conexión SQL
			oErrorController;			&& Control de errores
		)
		
		oForm = CREATEOBJECT(;
			"clForm", ;		&& Referencia de mi clase FORM Base
			oController;	&& Controlador
		)
		
		* Objetos del formulario
		oForm.AddObject("oLabel", "clLabel", "Consultar Usuario")
		oForm.AddObject("oContainer", "clContainer")
		oForm.AddObject("oConfirmbutton", "clConfirmButton")
		oForm.AddObject("oCancelButton", "clCancelButton")
		
		* Mostrar el formulario
		oForm.Show(1)
		
		* Liberar procedimientos
		RELEASE PROCEDURE;
			"clUserController", ;
			"clConnectionSQL", ;
			"clErrorController", ;
			"clForm"
	ENDPROC
	

	* /// <summary>
	* /// Procedimiento SetPath: Definir rutas
	* /// </summary>
	HIDDEN PROCEDURE SetPath()
		SET PATH TO ;
			"Context; " + ;
			"Controller; " + ;
			"Model\Entities; " + ;
			"Model\Business"
	ENDPROC

	* /// <summary>
	* /// Función GetConnection: Conexión BD SQL
	* /// </summary>
	HIDDEN FUNCTION GetConnection()
		LOCAL cConnectionString AS String
		
		cConnectionString = "Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=POO_VFP;Data Source=OPA119\SQL2022"
		
		oConnectionSQL = CREATEOBJECT("clConnectionSQL", cConnectionString)
		
		oConnectionSQL.OpenConnection()
		
		return oConnectionSQL
	ENDFUNC

	* /// <summary>
	* /// Procedimiento Error: Maneja errores en tiempo de ejecución
	* /// </summary>
	* /// <paragramList>
	* /// 	<param Name="nError">	Número del error	</param>
	* /// 	<param Name="cMethod">	Nombre del metodo	</param>
	* /// 	<param Name="nLine">	Número de linea		</param>
	* /// </paragramList>
	*PROCEDURE Error(nError AS Number, cMethod AS String, nLine AS Number)
		*DO clErrorController
		*This.oError.HandleError(nError, cMethod, nLine, This.Class)
	*ENDPROC
ENDDEFINE
